<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Concepts · CryoGrid.jl</title><meta name="title" content="Concepts · CryoGrid.jl"/><meta property="og:title" content="Concepts · CryoGrid.jl"/><meta property="twitter:title" content="Concepts · CryoGrid.jl"/><meta name="description" content="Documentation for CryoGrid.jl."/><meta property="og:description" content="Documentation for CryoGrid.jl."/><meta property="twitter:description" content="Documentation for CryoGrid.jl."/><meta property="og:url" content="https://cryogrid.github.io/CryoGrid.jl/v0/dev/concepts/"/><meta property="twitter:url" content="https://cryogrid.github.io/CryoGrid.jl/v0/dev/concepts/"/><link rel="canonical" href="https://cryogrid.github.io/CryoGrid.jl/v0/dev/concepts/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CryoGrid.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation/">Installation</a></li><li><a class="tocitem" href="../../quickstart/">Getting Started</a></li><li><span class="tocitem">User manual</span><ul><li><a class="tocitem" href="../../manual/overview/">Overview</a></li><li><a class="tocitem" href="../../manual/architecture/">Architecture</a></li><li><a class="tocitem" href="../../manual/coupling/">Coupling layers and processes</a></li></ul></li><li><span class="tocitem">Developer guide</span><ul><li class="is-active"><a class="tocitem" href>Concepts</a><ul class="internal"><li><a class="tocitem" href="#Multiple-dispatch"><span>Multiple dispatch</span></a></li></ul></li><li><a class="tocitem" href="../debugging/">Debugging</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/heat_freeW_bucketW_samoylov/">Soil heat with bucket water scheme</a></li><li><a class="tocitem" href="../../examples/heat_freeW_lite_implicit/">Fast heat conduction with CryoGridLite</a></li><li><a class="tocitem" href="../../examples/heat_freeW_samoylov/">Soil heat with free water freeze curve</a></li><li><a class="tocitem" href="../../examples/heat_freeW_seb_snow_bucketW_samoylov/">Soil heat w/ SEB, snow cover, and bucket water scheme</a></li><li><a class="tocitem" href="../../examples/heat_freeW_snow_samoylov/">Soil heat with bulk snow scheme</a></li><li><a class="tocitem" href="../../examples/heat_sfcc_constantbc/">Soil heat with SFCC and constant BCs</a></li><li><a class="tocitem" href="../../examples/heat_sfcc_salt_constantbc/">Coupled heat and salt diffusion on salty soil column</a></li><li><a class="tocitem" href="../../examples/heat_sfcc_samoylov/">Soil heat with SFCC</a></li><li><a class="tocitem" href="../../examples/heat_simple_autodiff_grad/">Computing parameter sensitivities with autodiff</a></li></ul></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../api/">Index</a></li><li><a class="tocitem" href="../../api/toplevel/">CryoGrid</a></li><li><a class="tocitem" href="../../api/numerics/">Numerics</a></li><li><a class="tocitem" href="../../api/utils/">Utilities</a></li><li><input class="collapse-toggle" id="menuitem-7-5" type="checkbox"/><label class="tocitem" for="menuitem-7-5"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/physics/heat_conduction/">Heat Conduction</a></li><li><a class="tocitem" href="../../api/physics/hydrology/">Hydrology</a></li><li><a class="tocitem" href="../../api/physics/soils/">Soils</a></li><li><a class="tocitem" href="../../api/physics/snow/">Snow</a></li><li><a class="tocitem" href="../../api/physics/seb/">Surface Energy Balance</a></li><li><a class="tocitem" href="../../api/physics/salt/">Salt</a></li></ul></li><li><a class="tocitem" href="../../api/tiles/">Tiles</a></li><li><input class="collapse-toggle" id="menuitem-7-7" type="checkbox"/><label class="tocitem" for="menuitem-7-7"><span class="docs-label">Solvers</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../api/solvers/basic_solvers/">Built-in</a></li><li><a class="tocitem" href="../../api/solvers/diffeq/">SciML/DiffEq</a></li><li><a class="tocitem" href="../../api/solvers/lite_implicit/">CryoGridLite</a></li></ul></li><li><a class="tocitem" href="../../api/diagnostics/">Diagnostics</a></li><li><a class="tocitem" href="../../api/presets/">Presets</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Developer guide</a></li><li class="is-active"><a href>Concepts</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Concepts</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CryoGrid/CryoGrid.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CryoGrid/CryoGrid.jl/blob/master/docs/src/dev/concepts.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="concepts"><a class="docs-heading-anchor" href="#concepts">Concepts</a><a id="concepts-1"></a><a class="docs-heading-anchor-permalink" href="#concepts" title="Permalink"></a></h1><p>This page provides a brief(-ish) overview of the basic programming and Julia-language concepts needed in order to develop and extend CryoGrid.jl.</p><h2 id="Multiple-dispatch"><a class="docs-heading-anchor" href="#Multiple-dispatch">Multiple dispatch</a><a id="Multiple-dispatch-1"></a><a class="docs-heading-anchor-permalink" href="#Multiple-dispatch" title="Permalink"></a></h2><p>The <a href="https://github.com/CryoGrid/CryoGridCommunity_source">CryoGrid community model</a> in MATLAB reuses code through <a href>object-oriented programming</a> (OOP), namely by separating process implementations into standalone classes. These classes are then subtyped by layer classes (e.g. <code>GROUND_freeW_ubT</code>) which then inherit their state variables, parameters, and functions.</p><p>Unlike MATLAB, Julia is not object-oriented and has no concept of a class (the closest equivalent is a <a href="https://docs.julialang.org/en/v1/manual/types/#Composite-Types">struct</a>). Furthermore, while Julia allows for inheritance from <a href="https://docs.julialang.org/en/v1/manual/types/#man-abstract-types">abstract types</a>, it does not allow <code>struct</code>s to inherit from other <code>struct</code>s, as explained by the <a href="https://docs.julialang.org/en/v1/manual/types/">Julia documentation</a>:</p><blockquote><p>One particularly distinctive feature of Julia&#39;s type system is that concrete types may not subtype each other: all concrete types are final and may only have abstract types as their supertypes. While this might at first seem unduly restrictive, it has many beneficial consequences with surprisingly few drawbacks. It turns out that being able to inherit behavior is much more important than being able to inherit structure, and inheriting both causes significant difficulties in traditional object-oriented languages.</p></blockquote><p>In light of this, CryoGrid.jl takes a different approach to effectively reuse code between model components. Rather than having layers &quot;inherit&quot; processes, subtypes of <code>Layer</code> are <em>composed</em> of one or more processes as well as parameter types which then determine which methods are invoked at runtime. This is facilitated by one of Julia&#39;s key features, <a href="https://docs.julialang.org/en/v1/manual/methods/#Defining-Methods">multiple dispatch</a>. Multiple dispatch means that methods are dynamically invoked based on the (runtime) types of <em>all</em> their arguments. This is in constrast to most OOP languages (also MATLAB) where dynamic dispatch occurs based on only one (implicit) argument, i.e. the type of the &quot;object&quot; or class itself. As an example, consider the <code>CryoGrid</code> method <code>computediagnostic!</code>:</p><pre><code class="language-julia hljs">using CryoGrid

# Declare two new SubSurface layer types;
# note that &lt;: basically means &quot;is a subtype of&quot;
struct Foo &lt;: SubSurface end
struct Bar &lt;: SubSurface end

CryoGrid.computediagnostic!(layer::Foo, state) = println(&quot;hello Foo&quot;)
CryoGrid.computediagnostic!(layer::Bar, state) = println(&quot;hello Bar&quot;)

state = nothing # we can ignore the state for the sake of the example
computediagnostic!(Foo(), state)
computediagnostic!(Bar(), state)</code></pre><p>Output:</p><pre><code class="nohighlight hljs">hello Foo
hello Bar</code></pre><p>In this example, we can see that which <code>computediagnostic!</code> implementation gets invoked is determined by which type is supplied by the caller.</p><p>Multiple dispatch allows us to extend this naturally to cases where more than one method argument has a declared type:</p><pre><code class="language-julia hljs">struct MyProcess &lt;: SubSurfaceProcess end

CryoGrid.computediagnostic!(::SubSurface, ::MyProcess, state) = println(&quot;hello MyProcess on any SubSurface&quot;)
CryoGrid.computediagnostic!(::Bar, ::MyProcess, state) = println(&quot;hello MyProcess on Bar&quot;)

computediagnostic!(Layer1(), MyProcess() state)
computediagnostic!(Layer2(), MyProcess(), state)</code></pre><p>Output:</p><pre><code class="nohighlight hljs">hello MyProcess on any SubSurface
hello MyProcess on Bar</code></pre><p>Thus, multiple dispatch allows us to write generic code in <code>computediagnostic!</code> that implements <code>MyProcess</code> for any <code>SubSurface</code> layer (i.e. the parent type of both <code>Foo</code> and <code>Bar</code>) in addition to adding specialized code for more specific layer types.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../manual/coupling/">« Coupling layers and processes</a><a class="docs-footer-nextpage" href="../debugging/">Debugging »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.2 on <span class="colophon-date" title="Friday 27 October 2023 17:10">Friday 27 October 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
